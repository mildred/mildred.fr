<!DOCTYPE html>
<html>
  <head>
    <title>Lysaac and clusters - Mildred's Website</title>
    <meta charset='utf-8' />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type' />
    <meta content='comp, dev, lisaac, lysaac, en' name='keywords' />
    <meta content='' name='description' />
    <meta content='initial-scale=1.0, width=device-width' name='viewport' />
    <meta content='article' name='x-kind' />
    <link href='http://mildred.fr/Blog/2011/04/12/lysaac_and_clusters/' rel='canonical' />
    <link href='../../../../../favicon.png' rel='icon' type='image/png' />
    <link href='../../../../../favicon.png' rel='shortcut icon' type='image/png' />
    <link href='../../../../../style.css' media='screen' rel='stylesheet' type='text/css' />
    <script src='../../../../../Scripts/json/json2.js' type='text/javascript'></script>
    <script src='../../../../../Scripts/jquery.min.js' type='text/javascript'></script>
    <script src='../../../../../Scripts/comments.js' type='text/javascript'></script>
    <script src='../../../../../Scripts/local.js' type='text/javascript'></script>
    <link rel="index" href="../../../../index.html" />
  </head>
  <body>
    <div class="header">
      <p class="access-links">
        <a href="#menu">Go to Menu</a>
        <br />
        <a href="#content">Go to Content</a>
      </p>
      <div class="left">
        <a href="../../../../../index.html">
          <img alt="My photo" class="photo" src="../../../../../Images/IMG_5669_square_128.jpeg"/>
        </a>
      </div>
      <div class="title">
        <h1>
          <a href="../../../../../index.html">Mildred's Website</a>
        </h1>
      </div>
      <div class="float-right"></div>
      <div class="clear-right"></div>
      <div class="right">
        <strong>Tags:</strong>
        <ul class="tags">
          <li>
            <a class="tag" href="../../../../../tags/cobra/index.html">cobra</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/comp/index.html">comp</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/configuration/index.html">configuration</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/dev/index.html">dev</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/dream/index.html">dream</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/en/index.html">en</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/fedora/index.html">fedora</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/fr/index.html">fr</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/freedombox/index.html">freedombox</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/git/index.html">git</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/html/index.html">html</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/idea/index.html">idea</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/liens/index.html">liens</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/lisaac/index.html">lisaac</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/lysaac/index.html">lysaac</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/misc/index.html">misc</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/photos/index.html">photos</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/physics/index.html">physics</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/politique/index.html">politique</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/privacy/index.html">privacy</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/srs/index.html">srs</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/test/index.html">test</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/web/index.html">web</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/website/index.html">website</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/wwwgen/index.html">wwwgen</a>
          </li>
          <li>
            <a class="tag" href="../../../../../tags/wwwsupport/index.html">wwwsupport</a>
          </li>
        </ul>
      </div>
      <div class="content">
        <div class="links" id="menu">
          <ul>
            <li>
              <a href="../../../../../index.html">Home</a>
            </li>
            <li>
              <a href="../../../../index.html">Blog</a>
            </li>
            <li>
              <a href="//survie.mildred.fr">Survie</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="clear"></div>
    </div>
    <div class="leftcol">
      <img alt="My avatar" class="photo" src="../../../../../Images/all128.jpeg"/>
      <hr/>
      <p>GoogleTalk, Jabber, XMPP address:
      <br /><strong><a href="xmpp:mildred&#64;jabber.fr">mildred&#64;jabber.fr</a></strong><!--&nbsp;<img src="http://presence.jabberfr.org/2dc519ffec76a836c2f2c2f66ac38291/image-dcraven.png" alt=""/><br /><em><script type="text/javascript" src="http://presence.jabberfr.org/2dc519ffec76a836c2f2c2f66ac38291/message_js.js"></script></em>-->
      </p>
      <hr/>
      <p>
        <a href="../../../../../gpg_key.txt">GPG Public Key</a>
        <br />
        <span style="font-size: 0.8em">
          (Fingerprint 197C A7E6 645B 4299 6D37 684B 6F9D A8D6 9A7D 2E2B)
        </span>
      </p>
    </div>
    <div class='main' id='content'>
      <h1>Lysaac and clusters</h1>
<p class='meta'>
  <span class='date-time'>
    <span class='date'>Tue 12 Apr 2011,</span>
    <span class='time'>04:35 PM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class="tag" href="../../../../../tags/comp/index.html">comp</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../../../../tags/dev/index.html">dev</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../../../../tags/en/index.html">en</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../../../../tags/lisaac/index.html">lisaac</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../../../../tags/lysaac/index.html">lysaac</a>
    </span>
  </span>
</p>
<div class="body"><p>If you noticed, I started my own Lisaac compiler, called <a href="http://github.com/mildred/lysaac">Lysaac</a> and I want
to make it a little bit different from Lisaac. I'll try to keep compatibility,
but for few things, I might take a different direction.</p>

<p>One of these things is the way prototypes are found.</p>

<p>In Lisaac, you have a complete set of prototypes and when you look for a
prototype, it is looked everywhere. This is not desirable. Imagine you are
writing a library that requires the prototype <code>FOO</code>. Currently, if <code>FOO</code> is not
present in the library, instead of issuing an error, the compiler would take the
<code>FOO</code> prototype in the application that use the library. Meaning that the
library is effectvely using a pieve of the application code.</p>

<p>I want to take the SmartEiffel approach and separate the source code in few
clusters. A cluster is a collection of prototypes. And the prototypes in a
cluster can only use the prototype of the same cluster or the prototypes of
imported clusters. This solve the above dependancy problem.</p>

<p>A cluster is a directory that contain prototypes in <code>.li</code> files and
subdirectories. If a subdirectory do not contain <code>.li</code> files, the
sub-subdirectories are not recursively searched. A cluster can import another
cluster using a cluster file ending with <code>.cli</code>.</p>

<p>An example of <code>.cli</code> file is as follows:</p>

<pre><code>Section Header&#x000A;&#x000A;  - name := Cluster LIBFOO;&#x000A;&#x000A;  - path := ("libfoo-3.14", "../libfoo");&#x000A;</code></pre>

<p>The search paths can be:</p>

<ul>
<li>relative to the <code>.cli</code> file if it starts with <code>.</code></li>
<li>relative to <code>LYSAAC_PATH</code> directories otherwise</li>
</ul>


<p><code>LISAAC_PATH</code> defaults to <code>$XDG_DATA_HOME/lysaac/lib:/usr/local/share/lysaac/lib:/usr/share/lysaac/lib</code>.</p>

<p>The search paths would then be for this example:</p>

<ul>
<li><code>$XDG_DATA_HOME/lysaac/lib/libfoo-3.14</code></li>
<li><code>/usr/local/share/lysaac/lib/libfoo-3.14</code></li>
<li><code>/usr/share/lysaac/lib/libfoo-3.14</code></li>
<li><code>../libfoo</code></li>
</ul>


<p>The parser for these files is being written. Then you can see the complete
hierarchy of the project:</p>

<pre><code>$ lysaac src&#x000A;◆ Root Cluster&#x000A;│ Cluster in: src&#x000A;├─◆ LIB (src/lib.cli)&#x000A;│ │ Cluster in: lib&#x000A;│ ├─◆ STDLIB (lib/stdlib.cli)&#x000A;│ │ │ Cluster in: /home/mildred/.local/share/lysaac/lib/stdlib&#x000A;│ │ ├─◇ STRING (...)&#x000A;│ │ ├─◇ ABSTRACT_STRING (...)&#x000A;│ │ ╰─◇ ...&#x000A;│ ├─◇ LIBC (lib/libc.li)&#x000A;│ ╰─◇ CSTRING (lib/cstring.li)&#x000A;├─◇ PARSER (src/parser.li)&#x000A;├─◇ CLUSTER_ITEM (src/cluster_item.li)&#x000A;├─◇ ITM_STYLE (src/itm_style.li)&#x000A;├─◇ LYSAAC (src/lysaac.li)&#x000A;├─◇ ITM_AFFECT (src/itm_affect.li)&#x000A;├─◇ ANY (src/any.li)&#x000A;├─◇ PARSER_CLI (src/parser_cli.li)&#x000A;╰─◇ CLUSTER (src/cluster.li)&#x000A;</code></pre>

<p>Now, each item in a cluster can be public or private. Public items are available
to the users of the clusters whereas private items are restricted to members of
the same cluster. To declare a private item, just say:</p>

<pre><code>Section Header&#x000A;&#x000A;  + name := Private PROTOTYPE;&#x000A;</code></pre>

<p>or</p>

<pre><code>Section Header&#x000A;&#x000A;  - name := Private Cluster LIBTOTO;&#x000A;</code></pre>

<p>If you want to declare a whole bunch of prototypes private to your cluster, just
include them in a private cluster. To do so, you'll need the following files:</p>

<ul>
<li><p>cluster/my_private_prototypes.cli:</p>

<pre><code>Section Header&#x000A;&#x000A;  - name := Private Cluster MY_PRIVATE_PROTOTYPES;&#x000A;&#x000A;  - path := "./deps/my_private_prototypes";&#x000A;  // makes the cluster relative to the .cli file&#x000A;  // use a deps additional directory to avoid the current cluster to&#x000A;  // look into deps/my_private_prototypes. deps should not contain any&#x000A;  // files, just subdirectories.&#x000A;</code></pre></li>
<li><p>cluster/deps/my_private_prototypes/private_proto.li:</p>

<pre><code>Section Header&#x000A;&#x000A;  + name := Public Prototype PRIVATE_PROTO;&#x000A;</code></pre></li>
</ul></div>
      <noscript>
        <p>
          Scripts are disabled on your computer. In order to access existing
          comments and post new comments, you need to enable Javascript.
        </p>
        <p>
          Rationale: This server that hosts my website is a static server.
          In order to implement comments, a XmlHttpRequest is made on an API
          server to both retrieve the comments and post a new comment.
        </p>
      </noscript>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
    <div class="footer">
      <hr/>
      <p>E-mail:
        <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#37;&#54;&#68;&#37;&#54;&#57;&#37;&#54;&#67;&#37;&#54;&#52;&#37;&#55;&#50;&#37;&#54;&#53;&#37;&#54;&#52;&#37;&#50;&#68;&#37;&#55;&#48;&#37;&#55;&#53;&#37;&#54;&#50;&#37;&#50;&#68;&#37;&#51;&#49;&#37;&#52;&#48;&#37;&#54;&#68;&#37;&#54;&#57;&#37;&#54;&#67;&#37;&#54;&#52;&#37;&#55;&#50;&#37;&#54;&#53;&#37;&#54;&#52;&#37;&#50;&#69;&#37;&#54;&#54;&#37;&#55;&#50;">&#109;&#105;&#108;&#100;&#114;&#101;&#100;&#45;&#112;&#117;&#98;&#45;&#49;&#64;&#109;&#105;&#108;&#100;&#114;&#101;&#100;&#46;&#102;&#114;</a>
      </p>
      <p>Mildred's Website: <a href="http://mildred.fr">http://mildred.fr</a>.
      I try to have <a href="http://www.w3.org/Provider/Style/URI">cools URI that don't change</a>.</p>
    </div>
  </body>
</html>
