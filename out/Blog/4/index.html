<!DOCTYPE html>
<html>
  <head>
    <title>Articles - Mildred's Website</title>
    <meta charset='utf-8' />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type' />
    <meta content='' name='keywords' />
    <meta content='' name='description' />
    <meta content='initial-scale=1.0, width=device-width' name='viewport' />
    <meta content='index' name='x-kind' />
    <link href='http://mildred.fr/Blog/4/' rel='canonical' />
    <link href='../../favicon.png' rel='icon' type='image/png' />
    <link href='../../favicon.png' rel='shortcut icon' type='image/png' />
    <link href='../../style.css' media='screen' rel='stylesheet' type='text/css' />
    <link href='../atom.xml' rel='alternate' title='ATOM Feed' type='application/atom+xml' />
    <link href='../rss.xml' rel='alternate' title='RSS Feed' type='application/rss+xml' />
    <script src='../../Scripts/json/json2.js' type='text/javascript'></script>
    <script src='../../Scripts/jquery.min.js' type='text/javascript'></script>
    <script src='../../Scripts/comments.js' type='text/javascript'></script>
    <script src='../../Scripts/local.js' type='text/javascript'></script>
  </head>
  <body>
    <div class="header">
      <p class="access-links">
        <a href="#menu">Go to Menu</a>
        <br />
        <a href="#content">Go to Content</a>
      </p>
      <div class="left">
        <a href="../../index.html">
          <img alt="My photo" class="photo" src="../../Images/IMG_5669_square_128.jpeg"/>
        </a>
      </div>
      <div class="title">
        <h1>
          <a href="../../index.html">Mildred's Website</a>
        </h1>
      </div>
      <div class="float-right"></div>
      <div class="clear-right"></div>
      <div class="right">
        <strong>Tags:</strong>
        <ul class="tags">
          <li>
            <a class="tag" href="../../tags/cobra/index.html">cobra</a>
          </li>
          <li>
            <a class="tag" href="../../tags/comp/index.html">comp</a>
          </li>
          <li>
            <a class="tag" href="../../tags/configuration/index.html">configuration</a>
          </li>
          <li>
            <a class="tag" href="../../tags/dev/index.html">dev</a>
          </li>
          <li>
            <a class="tag" href="../../tags/dream/index.html">dream</a>
          </li>
          <li>
            <a class="tag" href="../../tags/en/index.html">en</a>
          </li>
          <li>
            <a class="tag" href="../../tags/fedora/index.html">fedora</a>
          </li>
          <li>
            <a class="tag" href="../../tags/fr/index.html">fr</a>
          </li>
          <li>
            <a class="tag" href="../../tags/freedombox/index.html">freedombox</a>
          </li>
          <li>
            <a class="tag" href="../../tags/git/index.html">git</a>
          </li>
          <li>
            <a class="tag" href="../../tags/html/index.html">html</a>
          </li>
          <li>
            <a class="tag" href="../../tags/idea/index.html">idea</a>
          </li>
          <li>
            <a class="tag" href="../../tags/liens/index.html">liens</a>
          </li>
          <li>
            <a class="tag" href="../../tags/lisaac/index.html">lisaac</a>
          </li>
          <li>
            <a class="tag" href="../../tags/lysaac/index.html">lysaac</a>
          </li>
          <li>
            <a class="tag" href="../../tags/misc/index.html">misc</a>
          </li>
          <li>
            <a class="tag" href="../../tags/photos/index.html">photos</a>
          </li>
          <li>
            <a class="tag" href="../../tags/physics/index.html">physics</a>
          </li>
          <li>
            <a class="tag" href="../../tags/politique/index.html">politique</a>
          </li>
          <li>
            <a class="tag" href="../../tags/privacy/index.html">privacy</a>
          </li>
          <li>
            <a class="tag" href="../../tags/srs/index.html">srs</a>
          </li>
          <li>
            <a class="tag" href="../../tags/test/index.html">test</a>
          </li>
          <li>
            <a class="tag" href="../../tags/web/index.html">web</a>
          </li>
          <li>
            <a class="tag" href="../../tags/website/index.html">website</a>
          </li>
          <li>
            <a class="tag" href="../../tags/wwwgen/index.html">wwwgen</a>
          </li>
          <li>
            <a class="tag" href="../../tags/wwwsupport/index.html">wwwsupport</a>
          </li>
        </ul>
      </div>
      <div class="content">
        <div class="links" id="menu">
          <ul>
            <li>
              <a href="../../index.html">Home</a>
            </li>
            <li>
              <a href="../index.html">Blog</a>
            </li>
            <li>
              <a href="//survie.mildred.fr">Survie</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="clear"></div>
    </div>
    <div class="leftcol">
      <img alt="My avatar" class="photo" src="../../Images/all128.jpeg"/>
      <hr/>
      <p>GoogleTalk, Jabber, XMPP address:
      <br /><strong><a href="xmpp:mildred&#64;jabber.fr">mildred&#64;jabber.fr</a></strong><!--&nbsp;<img src="http://presence.jabberfr.org/2dc519ffec76a836c2f2c2f66ac38291/image-dcraven.png" alt=""/><br /><em><script type="text/javascript" src="http://presence.jabberfr.org/2dc519ffec76a836c2f2c2f66ac38291/message_js.js"></script></em>-->
      </p>
      <hr/>
      <p>
        <a href="../../gpg_key.txt">GPG Public Key</a>
        <br />
        <span style="font-size: 0.8em">
          (Fingerprint 197C A7E6 645B 4299 6D37 684B 6F9D A8D6 9A7D 2E2B)
        </span>
      </p>
    </div>
    <div class='main' id='content'>
      <h1>Articles</h1>
      <p>Articles from 31 to 40</p>
      <div class="article-list">
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/03/22/update-bind-dns-from-avahi/index.html">How to update your Bind DNS Server from Avahi</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Tue 22 Mar 2011,</span>
    <span class='time'>10:10 AM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class="tag" href="../../tags/comp/index.html">comp</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/en/index.html">en</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/freedombox/index.html">freedombox</a>
    </span>
  </span>
</p>
<div class="excerpt">
  <p>Attention: this post contains wrong information. What I discovered wasn't a way
tu publish services to a DNS server but publish local workstations to the DNS.</p>

<p>Following my previous post, I wondered how to update the DNS server from Avahi.
<a href="http://www.gamers-forum.com/showthread.php?t=17882">I was not alone</a>. I found a script that could be run as a cron job that
does the job. The next step is to use Avahi notifications instead of pooling
every minute.</p>

<!--

Now, the script (in PHP, better to rewrite in something sensible):

    #!/usr/bin/php

    <?php
    $avahidata = explode("\n",`avahi-browse -ptr _workstation._tcp`);

    $hosts="server localhost\nzone local\n";
    $pointers="server localhost\nzone 0.168.192.in-addr.arpa\n";

    $oldhosts="server localhost\nzone local\n";
    $oldpointers="server localhost\nzone 0.168.192.in-addr.arpa\n";

    for($i=0;$i<count($avahidata)-1;$i++){
        $hostInformation=explode(";",$avahidata[$i]);
        if($hostInformation[0] != "=") continue;

        $hostname=$hostInformation[6];
        $hostaddr=$hostInformation[7];
        $ptraddr=implode(".",array_reverse(explode(".",$hostaddr)));

        $hosts.="update add $hostname 2400 A $hostaddr\n";
        $pointers.="update add $ptraddr.in-addr.arpa 2400 PTR $hostname\n";

        $oldhosts.="update delete $hostname A\n";
        $oldpointers.="update delete $ptraddr.in-addr.arpa PTR\n";
    }

    $hosts.="send\n";
    $pointers.="send\n";

    $oldhosts.="send\n";
    $oldpointers.="send\n";

    echo `cat .dns_purge_hosts | nsupdate`;
    echo `cat .dns_purge_pointers | nsupdate`;

    echo `echo "$hosts" | nsupdate`;
    echo `echo "$pointers" | nsupdate`;

    file_put_contents(".dns_purge_hosts",$oldhosts);
    file_put_contents(".dns_purge_pointers",$oldpointers);

    ?>

And configure Bind to allow updates from localhost:

    acl lan { 192.168.0/24; 127.0.0.1; };

    options {
        directory "/var/named";
        pid-file "/var/run/named/named.pid";
        auth-nxdomain yes;
        datasize default;
        listen-on { any; };
        forward first;
        forwarders {
            8.8.8.8;
            8.8.4.4;
        };
    };

    zone "local" {
        type master;
        file "local.zone";
        check-names ignore;
        allow-transfer { lan; };
        allow-update { lan; };
    };

    zone "0.168.192.in-addr.arpa" {
        type master;
        file "0.168.192.in-addr.arpa.zone";
        check-names ignore;
        allow-transfer { lan; };
        allow-update { lan; };
    };

-->


<p>Thanks to <a href="http://gamers-forum.com/member.php?u=35088">leica</a></p>

<p>edit: probably a better solution would to still use mDNS over unicast DNS (wide
area). See a post from <a href="http://0pointer.de/blog/projects/avahi-wide-area.html">Lennart Poettering</a>.</p>
</div></div>
          <div class="clear"></div>
        </div>
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/03/23/freedombox-connectivity/index.html">Freedombox Connectivity</a>
          </h2>
          <div>
              <p class='meta'>
                <span class='date-time'>
                  <span class='date'>Wed 23 Mar 2011,</span>
                  <span class='time'>09:21 AM</span>
                </span>
                <span class='tags'>
                  <span class='tag'>
                    <a class="tag" href="../../tags/comp/index.html">comp</a>
                  </span>
                  <span class='tag'>
                    <a class="tag" href="../../tags/en/index.html">en</a>
                  </span>
                  <span class='tag'>
                    <a class="tag" href="../../tags/freedombox/index.html">freedombox</a>
                  </span>
                </span>
              </p>
              <div class="excerpt">
                <p>Suppose we want to have an E-Mail server on the freedombox. We need connectivity
                for SMTP, the ability to accept inbound connections. Which is impossible behind
                a NAT.</p>
                
                <p>For E-Mails we also need a MX record in the DNS ... This is a problem if the
                network is completely hostile. In which case, the only solution is to have a
                somewhat P2P DNS database shared on freedombox. Access would then not be
                possible from the Internet.</p>
                
                <p>Now, more likely, we are only going to have access to a dynamix DNS, which is
                fine. The DNS would store records A, AAAA and MX. Perhaps some others. Still, we
                need not to rely on them too much and have the ability to communicate from
                freedombox to another even if there is no DNS for us.</p>
                
                <p>So ... it comes down to the firewall and NAT restrictions.</p>
                
                <p>I suppose we could:</p>
                
                <ul>
                <li><p>First, autoconfigure IPv4 and IPv6</p></li>
                <li><p>Try opening NAT ports using UPnP</p></li>
                <li><p>Check the IP connectivity. We suppose IPv6 is accessible from the Internet and
                we look to see if the IPv4 is in a range that is routable (not in a private
                non-routable range).</p>
                
                <p>Additionally, we could ask a service on the Internet to test our connectivity
                if such a service is available. Both for IPv4 and IPv6.</p></li>
                <li><p>If we don't have an IPv6 connectivity, open a tunnel to the IPv6 Internet.
                Either Toredo or a manually configured tunnel if available.</p></li>
                <li><p>Update our DNS record</p></li>
                </ul>
                
                
                <p>So now, we have at least IPv6 available ... and we can at least communicate with
                the v6 Internet.</p>
              </div>
            </div>
          <div class="clear"></div>
        </div>
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/03/29/pipe-e/index.html">PIPE(E)</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Tue 29 Mar 2011,</span>
    <span class='time'>02:34 PM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class="tag" href="../../tags/comp/index.html">comp</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/en/index.html">en</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/lisaac/index.html">lisaac</a>
    </span>
  </span>
</p>
<div class="excerpt">
  <p>Inspired from ruby #Array:</p>

<pre><code>Section Header&#x000A;&#x000A;  + name := PIPE(E);&#x000A;&#x000A;Section Private&#x000A;&#x000A;  + blc :{;BOOLEAN,E};&#x000A;&#x000A;Section Public&#x000A;&#x000A;  - create blc_:{;BOOLEAN,E} :SELF &lt;-&#x000A;  (&#x000A;    blc := blc_;&#x000A;    Self&#x000A;  );&#x000A;&#x000A;  - read :(BOOLEAN,E) &lt;- blc.value&#x000A;&#x000A;  - map blc:{E;X} :PIPE(X) &lt;-&#x000A;  ( // Upvalue Self&#x000A;    PIPE(X).clone.make {&#x000A;      + have_e :BOOLEAN;&#x000A;      + e :E;&#x000A;      (have_e, e) := Self.read;&#x000A;      have_e.if {&#x000A;        e := blc.value e;&#x000A;      };&#x000A;      have_e, e&#x000A;    }&#x000A;  );&#x000A;&#x000A;  - select blc:{E;BOOLEAN} :PIPE(E) &lt;-&#x000A;  ( // Upvalue Self&#x000A;    PIPE(E).clone.make {&#x000A;      + have_e :BOOLEAN;&#x000A;      + e :E;&#x000A;      (have_e, e) := Self.read;&#x000A;      have_e.if {&#x000A;        blc.value e.if_false {&#x000A;          have_e := FALSE;&#x000A;        };&#x000A;      };&#x000A;      have_e, e&#x000A;    }&#x000A;  );&#x000A;&#x000A;  - flatten_1 :PIPE(X) &lt;-&#x000A;  ( // Upvalue Self, buffer&#x000A;    + buffer :PIPE(X);&#x000A;    PIPE(X).clone.make {&#x000A;      + have_e, have_x :BOOLEAN;&#x000A;      + e :E;&#x000A;      + x :X;&#x000A;      buffer.is_null.if_false {&#x000A;        (have_e, e) := buffer.read;&#x000A;        have_e.if_false {&#x000A;          buffer := NULL;&#x000A;        };&#x000A;      };&#x000A;      buffer.is_null.if {&#x000A;        (have_e, e) := Self.read;&#x000A;        have_e.if {&#x000A;          (buffer ?= e).is_null.if_false {&#x000A;            (have_x, x) := buffer.read&#x000A;            // TODO: cas où have_e = FALSE (buffer est vide)&#x000A;          };&#x000A;        };&#x000A;      };&#x000A;      have_x, x&#x000A;    }&#x000A;  );&#x000A;&#x000A;  - to_array_of_e :ARRAY(E) &lt;-&#x000A;  ( + result :ARRAY(E);&#x000A;    + have_e :BOOLEAN;&#x000A;    + e :E;&#x000A;    {(have_e, e) := read;&#x000A;    have_e&#x000A;    }.while_do {&#x000A;      result.add_last e;&#x000A;    };&#x000A;    result&#x000A;  );&#x000A;</code></pre>

<p>TODO:</p>

<ul>
<li>Upvalue</li>
<li>Syntax improvement (block input variables is too verbose)</li>
<li>More typing of parameter types, particurlarly as return values (map return unknown type X)</li>
<li><code>var := bool.if {val1} else {val2}</code></li>
<li>NULL.is_null -> TRUE</li>
</ul>
</div></div>
          <div class="clear"></div>
        </div>
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/04/11/update_to_nanoc/index.html">Update to nanoc</a>
          </h2>
          <div>
                <p class='meta'>
                  <span class='date-time'>
                    <span class='date'>Mon 11 Apr 2011,</span>
                    <span class='time'>05:38 PM</span>
                  </span>
                  <span class='tags'>
                    <span class='tag'>
                      <a class="tag" href="../../tags/en/index.html">en</a>
                    </span>
                    <span class='tag'>
                      <a class="tag" href="../../tags/fr/index.html">fr</a>
                    </span>
                    <span class='tag'>
                      <a class="tag" href="../../tags/website/index.html">website</a>
                    </span>
                  </span>
                </p>
                <div class="excerpt">
                  <p>Je vais maintenant gérer mon site avec <a href="http://nanoc.stoneship.org/index.html">nanoc</a>. Si vous remarquez des
                  problèmes comme des erreurs 404, merci de me l'indiquer.</p>
                  
                  <p>This web site is going to be updated using <a href="http://nanoc.stoneship.org/index.html">nanoc</a>. If you notice any dead
                  links or anything of the sort, please tell me.</p>
                </div>
              </div>
          <div class="clear"></div>
        </div>
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/04/12/lysaac_and_clusters/index.html">Lysaac and clusters</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Tue 12 Apr 2011,</span>
    <span class='time'>04:35 PM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class="tag" href="../../tags/comp/index.html">comp</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/dev/index.html">dev</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/en/index.html">en</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/lisaac/index.html">lisaac</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/lysaac/index.html">lysaac</a>
    </span>
  </span>
</p>
<div class="excerpt">
  <p>If you noticed, I started my own Lisaac compiler, called <a href="http://github.com/mildred/lysaac">Lysaac</a> and I want
to make it a little bit different from Lisaac. I'll try to keep compatibility,
but for few things, I might take a different direction.</p>

<p>One of these things is the way prototypes are found.</p>

<p>In Lisaac, you have a complete set of prototypes and when you look for a
prototype, it is looked everywhere. This is not desirable. Imagine you are
writing a library that requires the prototype <code>FOO</code>. Currently, if <code>FOO</code> is not
present in the library, instead of issuing an error, the compiler would take the
<code>FOO</code> prototype in the application that use the library. Meaning that the
library is effectvely using a pieve of the application code.</p>

<p>I want to take the SmartEiffel approach and separate the source code in few
clusters. A cluster is a collection of prototypes. And the prototypes in a
cluster can only use the prototype of the same cluster or the prototypes of
imported clusters. This solve the above dependancy problem.</p>

<p>A cluster is a directory that contain prototypes in <code>.li</code> files and
subdirectories. If a subdirectory do not contain <code>.li</code> files, the
sub-subdirectories are not recursively searched. A cluster can import another
cluster using a cluster file ending with <code>.cli</code>.</p>

<p>An example of <code>.cli</code> file is as follows:</p>

<pre><code>Section Header&#x000A;&#x000A;  - name := Cluster LIBFOO;&#x000A;&#x000A;  - path := ("libfoo-3.14", "../libfoo");&#x000A;</code></pre>

<p>The search paths can be:</p>

<ul>
<li>relative to the <code>.cli</code> file if it starts with <code>.</code></li>
<li>relative to <code>LYSAAC_PATH</code> directories otherwise</li>
</ul>


<p><code>LISAAC_PATH</code> defaults to <code>$XDG_DATA_HOME/lysaac/lib:/usr/local/share/lysaac/lib:/usr/share/lysaac/lib</code>.</p>

<p>The search paths would then be for this example:</p>

<ul>
<li><code>$XDG_DATA_HOME/lysaac/lib/libfoo-3.14</code></li>
<li><code>/usr/local/share/lysaac/lib/libfoo-3.14</code></li>
<li><code>/usr/share/lysaac/lib/libfoo-3.14</code></li>
<li><code>../libfoo</code></li>
</ul>


<p>The parser for these files is being written. Then you can see the complete
hierarchy of the project:</p>

<pre><code>$ lysaac src&#x000A;◆ Root Cluster&#x000A;│ Cluster in: src&#x000A;├─◆ LIB (src/lib.cli)&#x000A;│ │ Cluster in: lib&#x000A;│ ├─◆ STDLIB (lib/stdlib.cli)&#x000A;│ │ │ Cluster in: /home/mildred/.local/share/lysaac/lib/stdlib&#x000A;│ │ ├─◇ STRING (...)&#x000A;│ │ ├─◇ ABSTRACT_STRING (...)&#x000A;│ │ ╰─◇ ...&#x000A;│ ├─◇ LIBC (lib/libc.li)&#x000A;│ ╰─◇ CSTRING (lib/cstring.li)&#x000A;├─◇ PARSER (src/parser.li)&#x000A;├─◇ CLUSTER_ITEM (src/cluster_item.li)&#x000A;├─◇ ITM_STYLE (src/itm_style.li)&#x000A;├─◇ LYSAAC (src/lysaac.li)&#x000A;├─◇ ITM_AFFECT (src/itm_affect.li)&#x000A;├─◇ ANY (src/any.li)&#x000A;├─◇ PARSER_CLI (src/parser_cli.li)&#x000A;╰─◇ CLUSTER (src/cluster.li)&#x000A;</code></pre>

<p>Now, each item in a cluster can be public or private. Public items are available
to the users of the clusters whereas private items are restricted to members of
the same cluster. To declare a private item, just say:</p>

<pre><code>Section Header&#x000A;&#x000A;  + name := Private PROTOTYPE;&#x000A;</code></pre>

<p>or</p>

<pre><code>Section Header&#x000A;&#x000A;  - name := Private Cluster LIBTOTO;&#x000A;</code></pre>

<p>If you want to declare a whole bunch of prototypes private to your cluster, just
include them in a private cluster. To do so, you'll need the following files:</p>

<ul>
<li><p>cluster/my_private_prototypes.cli:</p>

<pre><code>Section Header&#x000A;&#x000A;  - name := Private Cluster MY_PRIVATE_PROTOTYPES;&#x000A;&#x000A;  - path := "./deps/my_private_prototypes";&#x000A;  // makes the cluster relative to the .cli file&#x000A;  // use a deps additional directory to avoid the current cluster to&#x000A;  // look into deps/my_private_prototypes. deps should not contain any&#x000A;  // files, just subdirectories.&#x000A;</code></pre></li>
<li><p>cluster/deps/my_private_prototypes/private_proto.li:</p>

<pre><code>Section Header&#x000A;&#x000A;  + name := Public Prototype PRIVATE_PROTO;&#x000A;</code></pre></li>
</ul>
</div></div>
          <div class="clear"></div>
        </div>
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/04/20/clusters_in_lysaac_works/index.html">Clusters in Lysaac works</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Wed 20 Apr 2011,</span>
    <span class='time'>11:17 AM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class="tag" href="../../tags/comp/index.html">comp</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/dev/index.html">dev</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/lysaac/index.html">lysaac</a>
    </span>
  </span>
</p>
<div class="excerpt">
  

<pre>&#x000A;◆ Root Cluster&#x000A;│ Cluster in: src&#x000A;├─◆ LIB (src/lib.cli)&#x000A;│ │ Cluster in: src/../lib&#x000A;│ ├─◇ PATH_HELPER (src/../lib/path_helper.li)&#x000A;│ ├─◇ CSTRING (src/../lib/cstring.li)&#x000A;│ ╰─◇ LIBC (src/../lib/libc.li)&#x000A;├─◇ PARSER (src/parser.li)&#x000A;├─◆ STDLIB (src/stdlib.cli)&#x000A;│ │ Cluster in: src/../stdlib/standard&#x000A;│ ├─◆ INTERNAL (src/../stdlib/standard/internal.cli)&#x000A;│ │ │ Cluster in: src/../stdlib/standard/../internal&#x000A;│ │ ├─◆ PORTABLE (src/../stdlib/standard/../internal/portable.cli)&#x000A;│ │ │ │ Cluster in: src/../stdlib/standard/../internal/portable&#x000A;│ │ │ ├─◇ FLOAT_REAL (src/../stdlib/standard/../internal/portable/number/float_real.li)&#x000A;│ │ │ ├─◇ FIXED_REAL (src/../stdlib/standard/../internal/portable/number/fixed_real.li)&#x000A;│ │ │ ├─◇ FLOAT_MAP80 (src/../stdlib/standard/../internal/portable/number/float_map80.li)&#x000A;│ │ │ ├─◇ SIGNED_INTEGER (src/../stdlib/standard/../internal/portable/number/signed_integer.li)&#x000A;│ │ │ ├─◇ FLOAT_MAP32 (src/../stdlib/standard/../internal/portable/number/float_map32.li)&#x000A;│ │ │ ├─◇ UNSIGNED_INTEGER (src/../stdlib/standard/../internal/portable/number/unsigned_integer.li)&#x000A;│ │ │ ├─◇ FLOAT_MAP64 (src/../stdlib/standard/../internal/portable/number/float_map64.li)&#x000A;│ │ │ ├─◇ SIGNED_FIXED_REAL (src/../stdlib/standard/../internal/portable/number/signed_fixed_real.li)&#x000A;│ │ │ ├─◇ NUMERIC (src/../stdlib/standard/../internal/portable/number/numeric.li)&#x000A;│ │ │ ├─◇ FLOAT_MAP (src/../stdlib/standard/../internal/portable/number/float_map.li)&#x000A;│ │ │ ├─◇ UNSIGNED_FIXED_REAL (src/../stdlib/standard/../internal/portable/number/unsigned_fixed_real.li)&#x000A;│ │ │ ├─◇ FILE_INPUT_STREAM (src/../stdlib/standard/../internal/portable/io/file_input_stream.li)&#x000A;│ │ │ ├─◇ STD_INPUT_OUTPUT (src/../stdlib/standard/../internal/portable/io/std_input_output.li)&#x000A;│ │ │ ├─◇ FILE_OUTPUT_STREAM (src/../stdlib/standard/../internal/portable/io/file_output_stream.li)&#x000A;│ │ │ ├─◇ INPUT_STREAM (src/../stdlib/standard/../internal/portable/io/input_stream.li)&#x000A;│ │ │ ├─◇ OUTPUT_STREAM (src/../stdlib/standard/../internal/portable/io/output_stream.li)&#x000A;│ │ │ ├─◇ MEMORY (src/../stdlib/standard/../internal/portable/memory/memory.li)&#x000A;│ │ │ ├─◇ SYSTEM_DETECT (src/../stdlib/standard/../internal/portable/system/system_detect.li)&#x000A;│ │ │ ├─◇ HASHED_DICTIONARY_NODE (src/../stdlib/standard/../internal/portable/collection/hashed_dictionary_node.li)&#x000A;│ │ │ ├─◇ COLLECTION (src/../stdlib/standard/../internal/portable/collection/collection.li)&#x000A;│ │ │ ├─◇ HASH_TABLE_SIZE (src/../stdlib/standard/../internal/portable/collection/hash_table_size.li)&#x000A;│ │ │ ├─◇ ANY_HASHED_BIJECTIVE_DICTIONARY_NODE (src/../stdlib/standard/../internal/portable/collection/any_hashed_bijective_dictionary_node.li)&#x000A;│ │ │ ├─◇ ANY_LINKED_LIST_NODE (src/../stdlib/standard/../internal/portable/collection/any_linked_list_node.li)&#x000A;│ │ │ ├─◇ ANY_AVL_SET_NODE (src/../stdlib/standard/../internal/portable/collection/any_avl_set_node.li)&#x000A;│ │ │ ├─◇ LINKED2_LIST_NODE (src/../stdlib/standard/../internal/portable/collection/linked2_list_node.li)&#x000A;│ │ │ ├─◇ ANY_AVL_DICTIONARY_NODE (src/../stdlib/standard/../internal/portable/collection/any_avl_dictionary_node.li)&#x000A;│ │ │ ├─◇ COLLECTION3 (src/../stdlib/standard/../internal/portable/collection/collection3.li)&#x000A;│ │ │ ├─◇ SET (src/../stdlib/standard/../internal/portable/collection/set.li)&#x000A;│ │ │ ├─◇ ANY_TWO_WAY_LINKED_LIST_NODE (src/../stdlib/standard/../internal/portable/collection/any_two_way_linked_list_node.li)&#x000A;│ │ │ ├─◇ HASHED_SET_NODE (src/../stdlib/standard/../internal/portable/collection/hashed_set_node.li)&#x000A;│ │ │ ├─◇ ARRAYED_COLLECTION (src/../stdlib/standard/../internal/portable/collection/arrayed_collection.li)&#x000A;│ │ │ ├─◇ SIMPLE_DICTIONARY (src/../stdlib/standard/../internal/portable/collection/simple_dictionary.li)&#x000A;│ │ │ ├─◇ DICTIONARY (src/../stdlib/standard/../internal/portable/collection/dictionary.li)&#x000A;│ │ │ ├─◇ AVL_DICTIONARY_NODE (src/../stdlib/standard/../internal/portable/collection/avl_dictionary_node.li)&#x000A;│ │ │ ├─◇ AVL_CONSTANTS (src/../stdlib/standard/../internal/portable/collection/avl_constants.li)&#x000A;│ │ │ ├─◇ ANY_HASHED_SET_NODE (src/../stdlib/standard/../internal/portable/collection/any_hashed_set_node.li)&#x000A;│ │ │ ├─◇ NATIVE_ARRAY (src/../stdlib/standard/../internal/portable/collection/native_array.li)&#x000A;│ │ │ ├─◇ AVL_TREE (src/../stdlib/standard/../internal/portable/collection/avl_tree.li)&#x000A;│ │ │ ├─◇ NATIVE_ARRAY_VOLATILE (src/../stdlib/standard/../internal/portable/collection/native_array_volatile.li)&#x000A;│ │ │ ├─◇ COLLECTION2 (src/../stdlib/standard/../internal/portable/collection/collection2.li)&#x000A;│ │ │ ├─◇ ANY_HASHED_DICTIONARY_NODE (src/../stdlib/standard/../internal/portable/collection/any_hashed_dictionary_node.li)&#x000A;│ │ │ ├─◇ ARRAYED (src/../stdlib/standard/../internal/portable/collection/arrayed.li)&#x000A;│ │ │ ├─◇ AVL_SET_NODE (src/../stdlib/standard/../internal/portable/collection/avl_set_node.li)&#x000A;│ │ │ ├─◇ LINKED_XOR_NODE (src/../stdlib/standard/../internal/portable/collection/linked_xor_node.li)&#x000A;│ │ │ ├─◇ LINKED_LIST_NODE (src/../stdlib/standard/../internal/portable/collection/linked_list_node.li)&#x000A;│ │ │ ├─◇ AVL_TREE_NODE (src/../stdlib/standard/../internal/portable/collection/avl_tree_node.li)&#x000A;│ │ │ ├─◇ LINKED_COLLECTION (src/../stdlib/standard/../internal/portable/collection/linked_collection.li)&#x000A;│ │ │ ├─◇ FS_MIN (src/../stdlib/standard/../internal/portable/file_system/fs_min.li)&#x000A;│ │ │ ├─◇ STRING_BUFFER (src/../stdlib/standard/../internal/portable/string/string_buffer.li)&#x000A;│ │ │ ╰─◇ CHARACTER_REF (src/../stdlib/standard/../internal/portable/string/character_ref.li)&#x000A;│ │ ╰─◆ UNIX (src/../stdlib/standard/../internal/unix.cli)&#x000A;│ │   │ Cluster in: src/../stdlib/standard/../internal/os_support/unix&#x000A;│ │   ├─◇ FLOAT_PROCESSOR (src/../stdlib/standard/../internal/os_support/unix/system/float_processor.li)&#x000A;│ │   ├─◇ SYSTEM (src/../stdlib/standard/../internal/os_support/unix/system/system.li)&#x000A;│ │   ├─◇ CLOCK (src/../stdlib/standard/../internal/os_support/unix/system/clock.li)&#x000A;│ │   ├─◇ ENVIRONMENT (src/../stdlib/standard/../internal/os_support/unix/system/environment.li)&#x000A;│ │   ├─◇ SYSTEM_IO (src/../stdlib/standard/../internal/os_support/unix/system/system_io.li)&#x000A;│ │   ├─◇ PROCESSOR (src/../stdlib/standard/../internal/os_support/unix/system/processor.li)&#x000A;│ │   ├─◇ EVENT_SYSTEM (src/../stdlib/standard/../internal/os_support/unix/video/event_system.li)&#x000A;│ │   ├─◇ KEYBOARD (src/../stdlib/standard/../internal/os_support/unix/video/keyboard.li)&#x000A;│ │   ├─◇ TIMER (src/../stdlib/standard/../internal/os_support/unix/video/timer.li)&#x000A;│ │   ├─◇ VIDEO (src/../stdlib/standard/../internal/os_support/unix/video/video.li)&#x000A;│ │   ├─◇ MOUSE (src/../stdlib/standard/../internal/os_support/unix/video/mouse.li)&#x000A;│ │   ├─◇ FILE_UNIX (src/../stdlib/standard/../internal/os_support/unix/file_system/file_unix.li)&#x000A;│ │   ├─◇ FILE_SYSTEM (src/../stdlib/standard/../internal/os_support/unix/file_system/file_system.li)&#x000A;│ │   ├─◇ ENTRY_UNIX (src/../stdlib/standard/../internal/os_support/unix/file_system/entry_unix.li)&#x000A;│ │   ├─◇ DIRECTORY_UNIX (src/../stdlib/standard/../internal/os_support/unix/file_system/directory_unix.li)&#x000A;│ │   ├─◇ BMP_LINE_ASCII (src/../stdlib/standard/../internal/os_support/unix/video_ascii/bmp_line_ascii.li)&#x000A;│ │   ├─◇ BITMAP_ASCII (src/../stdlib/standard/../internal/os_support/unix/video_ascii/bitmap_ascii.li)&#x000A;│ │   ├─◇ VIDEO (src/../stdlib/standard/../internal/os_support/unix/video_ascii/video.li)&#x000A;│ │   ╰─◇ PIXEL_ASCII (src/../stdlib/standard/../internal/os_support/unix/video_ascii/pixel_ascii.li)&#x000A;│ ├─◇ STD_ERROR (src/../stdlib/standard/io/std_error.li)&#x000A;│ ├─◇ COMMAND_LINE (src/../stdlib/standard/io/command_line.li)&#x000A;│ ├─◇ IO (src/../stdlib/standard/io/io.li)&#x000A;│ ├─◇ STD_INPUT (src/../stdlib/standard/io/std_input.li)&#x000A;│ ├─◇ STD_OUTPUT (src/../stdlib/standard/io/std_output.li)&#x000A;│ ├─◇ TIME (src/../stdlib/standard/time/time.li)&#x000A;│ ├─◇ DATE (src/../stdlib/standard/time/date.li)&#x000A;│ ├─◇ HASHABLE (src/../stdlib/standard/property/hashable.li)&#x000A;│ ├─◇ COMPARABLE (src/../stdlib/standard/property/comparable.li)&#x000A;│ ├─◇ SAFE_EQUAL (src/../stdlib/standard/property/safe_equal.li)&#x000A;│ ├─◇ TRAVERSABLE (src/../stdlib/standard/property/traversable.li)&#x000A;│ ├─◇ OBJECT (src/../stdlib/standard/kernel/object.li)&#x000A;│ ├─◇ I_DONT_KNOW_PROTOTYPING (src/../stdlib/standard/kernel/i_dont_know_prototyping.li)&#x000A;│ ├─◇ POINTER (src/../stdlib/standard/kernel/pointer.li)&#x000A;│ ├─◇ CONVERT (src/../stdlib/standard/kernel/convert.li)&#x000A;│ ├─◇ REFERENCE (src/../stdlib/standard/kernel/reference.li)&#x000A;│ ├─◇ BLOCK (src/../stdlib/standard/kernel/block.li)&#x000A;│ ├─◇ HASHED_DICTIONARY (src/../stdlib/standard/collection/hashed_dictionary.li)&#x000A;│ ├─◇ ARRAY2 (src/../stdlib/standard/collection/array2.li)&#x000A;│ ├─◇ AVL_SET (src/../stdlib/standard/collection/avl_set.li)&#x000A;│ ├─◇ LINKED2_LIST (src/../stdlib/standard/collection/linked2_list.li)&#x000A;│ ├─◇ ARRAY3 (src/../stdlib/standard/collection/array3.li)&#x000A;│ ├─◇ ARRAY (src/../stdlib/standard/collection/array.li)&#x000A;│ ├─◇ ITERATOR (src/../stdlib/standard/collection/iterator.li)&#x000A;│ ├─◇ FAST_ARRAY3 (src/../stdlib/standard/collection/fast_array3.li)&#x000A;│ ├─◇ LINKED_XOR_LIST (src/../stdlib/standard/collection/linked_xor_list.li)&#x000A;│ ├─◇ LINKED_LIST (src/../stdlib/standard/collection/linked_list.li)&#x000A;│ ├─◇ HASHED_SET (src/../stdlib/standard/collection/hashed_set.li)&#x000A;│ ├─◇ FAST_ARRAY2 (src/../stdlib/standard/collection/fast_array2.li)&#x000A;│ ├─◇ FAST_ARRAY (src/../stdlib/standard/collection/fast_array.li)&#x000A;│ ├─◇ AVL_DICTIONARY (src/../stdlib/standard/collection/avl_dictionary.li)&#x000A;│ ├─◇ STD_FILE (src/../stdlib/standard/file_system/std_file.li)&#x000A;│ ├─◇ DIRECTORY (src/../stdlib/standard/file_system/directory.li)&#x000A;│ ├─◇ ENTRY (src/../stdlib/standard/file_system/entry.li)&#x000A;│ ├─◇ FILE (src/../stdlib/standard/file_system/file.li)&#x000A;│ ├─◇ HTTP_SERVER (src/../stdlib/standard/http/http_server.li)&#x000A;│ ├─◇ HTTP_HEADER (src/../stdlib/standard/http/http_header.li)&#x000A;│ ├─◇ FALSE (src/../stdlib/standard/boolean/false.li)&#x000A;│ ├─◇ BOOLEAN (src/../stdlib/standard/boolean/boolean.li)&#x000A;│ ├─◇ TRUE (src/../stdlib/standard/boolean/true.li)&#x000A;│ ├─◇ STRING_CONSTANT (src/../stdlib/standard/string/string_constant.li)&#x000A;│ ├─◇ STRING (src/../stdlib/standard/string/string.li)&#x000A;│ ├─◇ ABSTRACT_STRING (src/../stdlib/standard/string/abstract_string.li)&#x000A;│ ╰─◇ CHARACTER (src/../stdlib/standard/string/character.li)&#x000A;├─◇ CLUSTER_ITEM (src/cluster_item.li)&#x000A;├─◇ ITM_STYLE (src/itm_style.li)&#x000A;├─◇ LYSAAC (src/lysaac.li)&#x000A;├─◇ ITM_AFFECT (src/itm_affect.li)&#x000A;├─◇ ANY (src/any.li)&#x000A;├─◇ PARSER_CLI (src/parser_cli.li)&#x000A;╰─◇ CLUSTER (src/cluster.li)</pre>
</div></div>
          <div class="clear"></div>
        </div>
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/04/22/comments/index.html">Comments</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Fri 22 Apr 2011,</span>
    <span class='time'>02:13 PM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class="tag" href="../../tags/en/index.html">en</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/website/index.html">website</a>
    </span>
  </span>
</p>
<div class="excerpt">
  <p>It is now possible to add comments in my blog. Comments are purely in
javascript, and you need a recent browser (Firefox 3.5 minimum). This is because
I use a cross-domain XmlHttpRequest.</p>

<p>How does it work?</p>

<p>I have a php script somewhere that understand two methods:</p>

<ul>
<li><p><strong>GET</strong> will return all the posted objects associated with a tag passed as a
REQUEST_URI (the thing after the question mark in URL)</p></li>
<li><p><strong>POST</strong> will add an item to this series.</p></li>
</ul>


<p>All of this in JSON of course, using jQuery.</p>

<p>Now, feel free to comment :)</p>
</div></div>
          <div class="clear"></div>
        </div>
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/04/24/static_website_architecture/index.html">Static website architecture</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Sun 24 Apr 2011,</span>
    <span class='time'>09:13 PM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class="tag" href="../../tags/en/index.html">en</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/website/index.html">website</a>
    </span>
  </span>
</p>
<div class="excerpt">
  <p>This website is made of static pages. I see two good reasons for that: first,
there is no need to recompute endlessly the same information. Then, with static
pages, you can leave your web site online forever without having it defaced.</p>

<p>So, how to create a modern web site with that? First, I have to start with what
I want:</p>

<ul>
<li>A blog, with the recent posts on the front page</li>
<li>An atom feed with the recent posts as well</li>
<li>Older posts on other pages</li>
<li>Each posts categorized in tags</li>
<li>Each tag having a page with posts in it</li>
<li>The tags pages must have atom feeds as well</li>
<li>And tag pages must be splitted in pages</li>
<li>Posts can have comments, anyone can add a comment</li>
</ul>


<p>This can be achieved using an off-line compiler that creates a hierarchy of HTML
files. Many of these compilers exists, I choose <a href="http://nanoc.stoneship.org">nanoc</a>,
but I had to customize it, mostly using <a href="http://github.com/mgutz/nanoc3_blog">nanoc3_blog</a>.</p>

<p>Some features can be easily provided:</p>

<ul>
<li>The atom feed can be created using a helper included in nanoc</li>
<li>The tags can be easily crafted using page attributes.</li>
<li>Tag pages can be created on the fly using a hand-made helper</li>
<li>Pagination can be done the same way</li>
</ul>


<p>Now, a word about design:</p>

<p><strong>Pagination,</strong> this is frowned upon by the nanoc author as demonstrated on the
<a href="http://nanoc.stoneship.org/docs/6-guides/#paginating-articles">guide</a>:</p>

<blockquote><p>First, a word of caution: I am not a fan of paginating items. Even though
pagination is fairly easy to do in nanoc, I recommend not doing it, for one
specific reason. Every time an object is added to a paginated collection, one
object shifts from one page to the next. When a paginated page is bookmarked,
it may show entirely different content a month later, and when a paginated
page turns up as a result on a search engine, it may no longer contain the
content that the person was looking for anymore. To avoid these issues, I
recommend creating separate pages for each category, tag or year. Having said
all this, I’ll nonetheless show you how to do pagination in nanoc, so you can
get an idea of how it can be done.</p></blockquote>

<p>In order to avoid having the object shifting pages, the most simple solution is
to have the pages remain static. Say you want to have 10 items per page, the
first page starts empty until it has 10 items. When an 11th item is added, a
second page is created with one element. For blogs, it might seem to be in
reverse order, but for archives, this is not a bad solution.</p>

<p>The pagination system must be uniform and available for any page on the website.
This way, the index page and tag page can have the same pagination system. The
pagination system must also support creating atom feeds. This way, we can have
a feed for the whole blog and a feed per tag. In nanoc, this can be done using
alternative representations for an item.</p>

<p><strong>Comments,</strong> can be done using JavaScript. For a first solution, this is
acceptable, even though having a solution working with user agents without
javascript is a goal. For this, we can use jQuery and XmlHttpRequest. Because
the server only provides static pages, XmlHttpRequest, having a same-origin
policy, will refuse to work. There are several solutions:</p>

<ul>
<li>Proxy the foreign resource on the local server. This unfortunately requires
<code>mod_proxy</code> which is not available on my server.</li>
<li>Another solution is to use <a href="http://www.w3.org/TR/cors/index.html">Cross Origin Resource Sharing</a>, a W3C
recommendation that is still a draft unfortunately, but is started to be
implemented.</li>
<li>Or to use an iframe with a page of the foreign server, and use the
postMessage method to communicate with it, for example with the
<a href="https://github.com/oyvindkinsey/easyXDM/index.html">easyXDM</a> library.</li>
<li>Or use HTML <code>&lt;form&gt;</code> element to post the comment on the the API server. The
server would then include the comment on the static page and publish it.
This unfortunately requires a server with more than a simple php scripting
ability. I don't have this.</li>
</ul>


<p>For now, I am using the XmlHttpRequest solution with the CORS mechanism on the
API server to allow communication. Here is where I'd like to move:</p>

<ul>
<li>First, integrate <a href="https://github.com/oyvindkinsey/easyXDM/index.html">easyXDM</a> for wider browser compatibility, at the
cost of the design.</li>
<li>Then, use a variation of the static HTML form.</li>
</ul>


<p>For the static form, here is what i'm thinking of:</p>

<ul>
<li>First, the client can POST the form on the PAI server. If XmlHttpRequest
with CORS is available, this can be done using Ajax, else we have to deal
with a page reload.</li>
<li>The server would store this message on the database with a unique UUID.</li>
<li>Other clients can access this message accessing the API server as usual.</li>
<li>Frequently, on my computer, I would dump the messages on the API server
database and put them in a local yaml file. Comments i'd like to remove can
then be removed here.</li>
<li>When the site is regenerated, a nanoc helper would read this yaml file and
put comments statically in the page. The page would then be published and
comments would be available to users without javascript.</li>
<li>The script that fetches comments would ignore received comments that are
already present statically on the page, based on the UUID.</li>
</ul>


<p>This way, comments would be available for everyone.</p>
</div></div>
          <div class="clear"></div>
        </div>
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/04/29/lysaac_compilation_model_and_inline_prototypes/index.html">Lysaac compilation model and inline prototypes</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Fri 29 Apr 2011,</span>
    <span class='time'>09:19 AM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class="tag" href="../../tags/comp/index.html">comp</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/dev/index.html">dev</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/en/index.html">en</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/lisaac/index.html">lisaac</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/lysaac/index.html">lysaac</a>
    </span>
  </span>
</p>
<div class="excerpt">
  <p>In Lysaac, I choose to follow the open world assumption, like the majority of
programming languages out there, instead of the closed world assumption. There
are two main reasons:</p>

<ul>
<li><p>First, I don't strive at creating an optimizing compiler, not yet at least.
Closed world is useful for that, but I don't need it.</p></li>
<li><p>Second, open world assumption increases the complexity a lot. The Lisaac
compiler uses an exponential algorithm, and will always hit a limit with
big projects. With an open world, you can partition the complexity.</p></li>
</ul>


<p>Because I still believe in global compilation, I decided that my compilation
unit would be the cluster instead of the prototype. That is, I'll compile a
cluster completely in one object file. That makes it possible to optimize things
like private prototypes.</p>

<p>This leaves a big performance problem for <code>BOOLEAN</code>s in particular. <code>BOOLEAN</code>,
<code>TRUE</code> and <code>FALSE</code> are prototypes in the standard library, and having an open
world assumption would require pasing to the <code>if then</code> slot function pointers.
I can't realisticly do that.</p>

<p>So, These prototypes could be marked as <code>Inline</code>. They are separated from their
cluster and gets compiled in every cluster that uses them. The syntax could be
quite simple:</p>

<pre><code>Section Header&#x000A;&#x000A;  + name := Inline TRUE;&#x000A;</code></pre>

<p>But, because each cluster is then free to compile it as it wants, there is a
problem of interoperability. How can you be sure that the <code>TRUE</code> in your cluster
is compiled the same way as in the neighbooring cluster you are using. As it is,
you can't pass <code>TRUE</code> object around clusters. Very annoying.</p>

<p>The solution would be to encode them and decode them manually. You could have:</p>

<pre><code>Section Header&#x000A;&#x000A;  + name := Inline TRUE;&#x000A;&#x000A;Section Feature&#x000A;&#x000A;  - inline_size :INTEGER := 0;&#x000A;</code></pre>

<p>Take a more interesting example:</p>

<pre><code>Section Header&#x000A;&#x000A;  + name := Inline Expanded BIT;&#x000A;&#x000A;  - size := 1;&#x000A;&#x000A;Section Feature&#x000A;&#x000A;  - inline_size :INTEGER := 1;&#x000A;  - encode p:POINTER &lt;-&#x000A;  (&#x000A;    p.to_native_array_of BIT.put bit to 0;&#x000A;  );&#x000A;  - decode p:POINTER &lt;-&#x000A;  (&#x000A;    data := p.to_native_array_of BIT.item 0;&#x000A;  );&#x000A;</code></pre>

<p>This needs to be refined.</p>

<p>Additionally, <code>.cli</code> files could also contain the <code>Inline</code> keyword. In that
case, the cluster it reference will be compiled with the current cluster. That
could be useful for private clusters.</p>
</div></div>
          <div class="clear"></div>
        </div>
        <div class="sub-article">
          <h2>
            <a class="permalink" href="../2011/04/29/lysaac_annotations/index.html">Lysaac annotations</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Fri 29 Apr 2011,</span>
    <span class='time'>09:40 AM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class="tag" href="../../tags/comp/index.html">comp</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/dev/index.html">dev</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/en/index.html">en</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/lisaac/index.html">lisaac</a>
    </span>
    <span class='tag'>
      <a class="tag" href="../../tags/lysaac/index.html">lysaac</a>
    </span>
  </span>
</p>
<div class="excerpt">
  <p>Because I'm using an open world assumption, I need the compiler to generate
annotations on units it compiles, so when it sees them again, it knows what it
does (or does not) internally.</p>

<p>I was looking at <a href="http://www.youtube.com/watch?v=ryfw9_-Hnb0">a LLVM video</a> this morning (VMKit precisely) and the
person talked about an interesting optimization. What if we could allocate
objects in stack instead of the heap. This would save time when creating the
object. Then we wouldn't be tempted to avoid creating new objects for fear of
memory leaks (there is not garbage collector in lisaac currently) and
performance penalty.</p>

<p>This is the same thing as aliased variables in Ada.</p>

<p>An object can be allocated on the stack if:</p>

<ul>
<li>it is not returned by the function.</li>
<li>it is not stored on the heap by the function.</li>
<li>it is not used in a called function that would store a pointer to this
object on the heap.</li>
</ul>


<p>So, when the compiler compiles a cluster, it has to generate an annotation file
containing for each argument in each code slot whether the argument is
guaranteed to remain on the stack or if it might be stored on the heap. If an
argument is guaranteed to stay on the stack, we can allocate it on the stack.
When the function will return, the only instances would be located in the
current stack frame.</p>
</div></div>
          <div class="clear"></div>
        </div>
      </div>
      <div class="page-list">
        <strong>Page:</strong>
        <ul class='page-list'>
          <li>
            <a href="../1/index.html">1</a>
          </li>
          <li>
            <a href="../2/index.html">2</a>
          </li>
          <li>
            <a href="../3/index.html">3</a>
          </li>
          <li>
            <strong>4</strong>
          </li>
          <li>
            <a href="../5/index.html">5</a>
          </li>
          <li>
            <a href="../6/index.html">6</a>
          </li>
          <li>
            <a href="../7/index.html">7</a>
          </li>
          <li>
            <a href="../index.html">latest</a>
          </li>
        </ul>
      </div>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
    <div class="footer">
      <hr/>
      <p>E-mail:
        <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#37;&#54;&#68;&#37;&#54;&#57;&#37;&#54;&#67;&#37;&#54;&#52;&#37;&#55;&#50;&#37;&#54;&#53;&#37;&#54;&#52;&#37;&#50;&#68;&#37;&#55;&#48;&#37;&#55;&#53;&#37;&#54;&#50;&#37;&#50;&#68;&#37;&#51;&#49;&#37;&#52;&#48;&#37;&#54;&#68;&#37;&#54;&#57;&#37;&#54;&#67;&#37;&#54;&#52;&#37;&#55;&#50;&#37;&#54;&#53;&#37;&#54;&#52;&#37;&#50;&#69;&#37;&#54;&#54;&#37;&#55;&#50;">&#109;&#105;&#108;&#100;&#114;&#101;&#100;&#45;&#112;&#117;&#98;&#45;&#49;&#64;&#109;&#105;&#108;&#100;&#114;&#101;&#100;&#46;&#102;&#114;</a>
      </p>
      <p>Mildred's Website: <a href="http://mildred.fr">http://mildred.fr</a>.
      I try to have <a href="http://www.w3.org/Provider/Style/URI">cools URI that don't change</a>.</p>
    </div>
  </body>
</html>
