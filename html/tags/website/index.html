<!DOCTYPE html>
<html>
  <head>
    <title>Category: website - Mildred's Website</title>
    <meta charset='utf-8'>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta content='' name='keywords'>
    <meta content='' name='description'>
    <meta content='initial-scale=1.0, width=device-width' name='viewport'>
    <meta content='tag' name='x-kind'>
    <link href='http://mildred.fr/tags/website/' rel='canonical'>
    <link href='../../favicon.png' rel='icon' type='image/png'>
    <link href='../../favicon.png' rel='shortcut icon' type='image/png'>
    <link href='../../style.css' media='screen' rel='stylesheet' type='text/css'>
    <link href='atom.xml' rel='alternate' title='ATOM Feed' type='application/atom+xml'>
    <link href='rss.xml' rel='alternate' title='RSS Feed' type='application/rss+xml'>
    <script src='../../Scripts/json/json2.js' type='text/javascript'></script>
    <script src='../../Scripts/jquery.min.js' type='text/javascript'></script>
    <script src='../../Scripts/comments.js' type='text/javascript'></script>
    <script src='../../Scripts/local.js' type='text/javascript'></script>
  </head>
  <body>
    <div class='header'>
      <p class='access-links'>
        <a href='#menu'>Go to Menu</a>
        <br>
        <a href='#content'>Go to Content</a>
      </p>
      <div class='left'>
        <a href='../../'>
          <img alt='My photo' class='photo' src='../../Images/IMG_5669_square_128.jpeg'>
        </a>
      </div>
      <div class='title'>
        <h1>
          <a href='../../'>Mildred's Website</a>
        </h1>
      </div>
      <div class='float-right'></div>
      <div class='clear-right'></div>
      <div class='right'>
        <strong>Tags:</strong>
        <ul class='tags'>
          <li>
            <a class='tag' href='../cobra/'>cobra</a>
          </li>
          <li>
            <a class='tag' href='../comp/'>comp</a>
          </li>
          <li>
            <a class='tag' href='../configuration/'>configuration</a>
          </li>
          <li>
            <a class='tag' href='../dev/'>dev</a>
          </li>
          <li>
            <a class='tag' href='../dream/'>dream</a>
          </li>
          <li>
            <a class='tag' href='../en/'>en</a>
          </li>
          <li>
            <a class='tag' href='../fedora/'>fedora</a>
          </li>
          <li>
            <a class='tag' href='../fr/'>fr</a>
          </li>
          <li>
            <a class='tag' href='../freedombox/'>freedombox</a>
          </li>
          <li>
            <a class='tag' href='../git/'>git</a>
          </li>
          <li>
            <a class='tag' href='../html/'>html</a>
          </li>
          <li>
            <a class='tag' href='../idea/'>idea</a>
          </li>
          <li>
            <a class='tag' href='../liens/'>liens</a>
          </li>
          <li>
            <a class='tag' href='../lisaac/'>lisaac</a>
          </li>
          <li>
            <a class='tag' href='../lysaac/'>lysaac</a>
          </li>
          <li>
            <a class='tag' href='../misc/'>misc</a>
          </li>
          <li>
            <a class='tag' href='../photos/'>photos</a>
          </li>
          <li>
            <a class='tag' href='../physics/'>physics</a>
          </li>
          <li>
            <a class='tag' href='../politique/'>politique</a>
          </li>
          <li>
            <a class='tag' href='../privacy/'>privacy</a>
          </li>
          <li>
            <a class='tag' href='../srs/'>srs</a>
          </li>
          <li>
            <a class='tag' href='../test/'>test</a>
          </li>
          <li>
            <a class='tag' href='../web/'>web</a>
          </li>
          <li>
            <a class='tag' href='./'>website</a>
          </li>
          <li>
            <a class='tag' href='../wwwgen/'>wwwgen</a>
          </li>
          <li>
            <a class='tag' href='../wwwsupport/'>wwwsupport</a>
          </li>
        </ul>
      </div>
      <div class='content'>
        <div class='links' id='menu'>
          <ul>
            <li>
              <a href='../../'>Home</a>
            </li>
            <li>
              <a href='../../Blog/'>Blog</a>
            </li>
            <li>
              <a href='//survie.mildred.fr'>Survie</a>
            </li>
          </ul>
        </div>
      </div>
      <div class='clear'></div>
    </div>
    <div class='leftcol'>
      <img alt='My avatar' class='photo' src='../../Images/all128.jpeg'>
      <hr>
      <p>GoogleTalk, Jabber, XMPP address:
      <br /><strong><a href="xmpp:mildred&#64;jabber.fr">mildred&#64;jabber.fr</a></strong><!--&nbsp;<img src="http://presence.jabberfr.org/2dc519ffec76a836c2f2c2f66ac38291/image-dcraven.png" alt="" /><br /><em><script type="text/javascript" src="http://presence.jabberfr.org/2dc519ffec76a836c2f2c2f66ac38291/message_js.js"></script></em>-->
      </p>
      <hr>
      <p>
        <a href='../../gpg_key.txt'>GPG Public Key</a>
        <br>
        <span style='font-size: 0.8em'>
          (Fingerprint 197C A7E6 645B 4299 6D37 684B 6F9D A8D6 9A7D 2E2B)
        </span>
      </p>
    </div>
    <div class='main' id='content'>
      <h1>Category: website</h1>
      <p>Articles from 1 to 4</p>
      <div class='article-list'>
        <div class='sub-article'>
          <h2>
            <a class='permalink' href='../../Blog/2012/06/21/a_new_way_to_update_my_blog/'>A new way to update my blog</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Thu 21 Jun 2012,</span>
    <span class='time'>03:08 PM</span>
  </span>
  <span class='author'>
    by
    <span class='author-name'>
      Mildred Ki'Lya
    </span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class='tag' href='../dev/'>dev</a>
    </span>
    <span class='tag'>
      <a class='tag' href='../en/'>en</a>
    </span>
    <span class='tag'>
      <a class='tag' href='./'>website</a>
    </span>
  </span>
</p>
<div class='excerpt'>
  <p>Hi everyone, I just developed a new way to update my blog. I am just
using my mailer (which is currently Thunderbird for a lack of a better
alternative). As you may know, I already manage my own server. I have a
nginx web server and my website is just plain old static pages generated
from markdown using my own version of webgen.</p>

<p>My code is available at two locations:</p>

<ul>
<li><a href="http://git.mildred.fr">my personal git server</a></li>
<li><a href="http://github.com/mildred/">github</a></li>
</ul>


<p>I just developed a few scripts which does the following:</p>

<ul>
<li>hooked in /etc/aliases, receive e-mail from a special e-mail address.
Put this mail in an inbox directory on the server</li>
<li>another daemon (a shell script run by daemontools actually) run as the
www-data user is monitoring the inbox using inotifywait. When a mail
comes, or every 60 seconds, it process the mail using a ruby script that
convert the mail to a markdown page, and run webgen on the website. It
also commit and push the changes.</li>
</ul>


<p>And that's all.</p>

<p>The one thing I couldn't automate is the creation of the private key to
push the changes back to the git server.</p>

<p>All the code <a href="http://git.mildred.fr/?p=pub/mildred/wwwsupport.git;a=summary">is
there</a>. I
just don't know if I have a public URl for these repos :)</p>
</div></div>
          <div class='clear'></div>
        </div>
        <div class='sub-article'>
          <h2>
            <a class='permalink' href='../../Blog/2011/04/24/static_website_architecture/'>Static website architecture</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Sun 24 Apr 2011,</span>
    <span class='time'>09:13 PM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class='tag' href='../en/'>en</a>
    </span>
    <span class='tag'>
      <a class='tag' href='./'>website</a>
    </span>
  </span>
</p>
<div class='excerpt'>
  <p>This website is made of static pages. I see two good reasons for that: first,
there is no need to recompute endlessly the same information. Then, with static
pages, you can leave your web site online forever without having it defaced.</p>

<p>So, how to create a modern web site with that? First, I have to start with what
I want:</p>

<ul>
<li>A blog, with the recent posts on the front page</li>
<li>An atom feed with the recent posts as well</li>
<li>Older posts on other pages</li>
<li>Each posts categorized in tags</li>
<li>Each tag having a page with posts in it</li>
<li>The tags pages must have atom feeds as well</li>
<li>And tag pages must be splitted in pages</li>
<li>Posts can have comments, anyone can add a comment</li>
</ul>


<p>This can be achieved using an off-line compiler that creates a hierarchy of HTML
files. Many of these compilers exists, I choose <a href="http://nanoc.stoneship.org">nanoc</a>,
but I had to customize it, mostly using <a href="http://github.com/mgutz/nanoc3_blog">nanoc3_blog</a>.</p>

<p>Some features can be easily provided:</p>

<ul>
<li>The atom feed can be created using a helper included in nanoc</li>
<li>The tags can be easily crafted using page attributes.</li>
<li>Tag pages can be created on the fly using a hand-made helper</li>
<li>Pagination can be done the same way</li>
</ul>


<p>Now, a word about design:</p>

<p><strong>Pagination,</strong> this is frowned upon by the nanoc author as demonstrated on the
<a href="http://nanoc.stoneship.org/docs/6-guides/#paginating-articles">guide</a>:</p>

<blockquote><p>First, a word of caution: I am not a fan of paginating items. Even though
pagination is fairly easy to do in nanoc, I recommend not doing it, for one
specific reason. Every time an object is added to a paginated collection, one
object shifts from one page to the next. When a paginated page is bookmarked,
it may show entirely different content a month later, and when a paginated
page turns up as a result on a search engine, it may no longer contain the
content that the person was looking for anymore. To avoid these issues, I
recommend creating separate pages for each category, tag or year. Having said
all this, I’ll nonetheless show you how to do pagination in nanoc, so you can
get an idea of how it can be done.</p></blockquote>

<p>In order to avoid having the object shifting pages, the most simple solution is
to have the pages remain static. Say you want to have 10 items per page, the
first page starts empty until it has 10 items. When an 11th item is added, a
second page is created with one element. For blogs, it might seem to be in
reverse order, but for archives, this is not a bad solution.</p>

<p>The pagination system must be uniform and available for any page on the website.
This way, the index page and tag page can have the same pagination system. The
pagination system must also support creating atom feeds. This way, we can have
a feed for the whole blog and a feed per tag. In nanoc, this can be done using
alternative representations for an item.</p>

<p><strong>Comments,</strong> can be done using JavaScript. For a first solution, this is
acceptable, even though having a solution working with user agents without
javascript is a goal. For this, we can use jQuery and XmlHttpRequest. Because
the server only provides static pages, XmlHttpRequest, having a same-origin
policy, will refuse to work. There are several solutions:</p>

<ul>
<li>Proxy the foreign resource on the local server. This unfortunately requires
<code>mod_proxy</code> which is not available on my server.</li>
<li>Another solution is to use <a href="http://www.w3.org/TR/cors/">Cross Origin Resource Sharing</a>, a W3C
recommendation that is still a draft unfortunately, but is started to be
implemented.</li>
<li>Or to use an iframe with a page of the foreign server, and use the
postMessage method to communicate with it, for example with the
<a href="https://github.com/oyvindkinsey/easyXDM/">easyXDM</a> library.</li>
<li>Or use HTML <code>&lt;form&gt;</code> element to post the comment on the the API server. The
server would then include the comment on the static page and publish it.
This unfortunately requires a server with more than a simple php scripting
ability. I don't have this.</li>
</ul>


<p>For now, I am using the XmlHttpRequest solution with the CORS mechanism on the
API server to allow communication. Here is where I'd like to move:</p>

<ul>
<li>First, integrate <a href="https://github.com/oyvindkinsey/easyXDM/">easyXDM</a> for wider browser compatibility, at the
cost of the design.</li>
<li>Then, use a variation of the static HTML form.</li>
</ul>


<p>For the static form, here is what i'm thinking of:</p>

<ul>
<li>First, the client can POST the form on the PAI server. If XmlHttpRequest
with CORS is available, this can be done using Ajax, else we have to deal
with a page reload.</li>
<li>The server would store this message on the database with a unique UUID.</li>
<li>Other clients can access this message accessing the API server as usual.</li>
<li>Frequently, on my computer, I would dump the messages on the API server
database and put them in a local yaml file. Comments i'd like to remove can
then be removed here.</li>
<li>When the site is regenerated, a nanoc helper would read this yaml file and
put comments statically in the page. The page would then be published and
comments would be available to users without javascript.</li>
<li>The script that fetches comments would ignore received comments that are
already present statically on the page, based on the UUID.</li>
</ul>


<p>This way, comments would be available for everyone.</p>
</div></div>
          <div class='clear'></div>
        </div>
        <div class='sub-article'>
          <h2>
            <a class='permalink' href='../../Blog/2011/04/22/comments/'>Comments</a>
          </h2>
          <div><p class='meta'>
  <span class='date-time'>
    <span class='date'>Fri 22 Apr 2011,</span>
    <span class='time'>02:13 PM</span>
  </span>
  <span class='tags'>
    <span class='tag'>
      <a class='tag' href='../en/'>en</a>
    </span>
    <span class='tag'>
      <a class='tag' href='./'>website</a>
    </span>
  </span>
</p>
<div class='excerpt'>
  <p>It is now possible to add comments in my blog. Comments are purely in
javascript, and you need a recent browser (Firefox 3.5 minimum). This is because
I use a cross-domain XmlHttpRequest.</p>

<p>How does it work?</p>

<p>I have a php script somewhere that understand two methods:</p>

<ul>
<li><p><strong>GET</strong> will return all the posted objects associated with a tag passed as a
REQUEST_URI (the thing after the question mark in URL)</p></li>
<li><p><strong>POST</strong> will add an item to this series.</p></li>
</ul>


<p>All of this in JSON of course, using jQuery.</p>

<p>Now, feel free to comment :)</p>
</div></div>
          <div class='clear'></div>
        </div>
        <div class='sub-article'>
          <h2>
            <a class='permalink' href='../../Blog/2011/04/11/update_to_nanoc/'>Update to nanoc</a>
          </h2>
          <div>
                  <p class='meta'>
                    <span class='date-time'>
                      <span class='date'>Mon 11 Apr 2011,</span>
                      <span class='time'>05:38 PM</span>
                    </span>
                    <span class='tags'>
                      <span class='tag'>
                        <a class='tag' href='../en/'>en</a>
                      </span>
                      <span class='tag'>
                        <a class='tag' href='../fr/'>fr</a>
                      </span>
                      <span class='tag'>
                        <a class='tag' href='./'>website</a>
                      </span>
                    </span>
                  </p>
                  <div class='excerpt'>
                    <p>Je vais maintenant gérer mon site avec <a href="http://nanoc.stoneship.org/">nanoc</a>. Si vous remarquez des
                    problèmes comme des erreurs 404, merci de me l'indiquer.</p>
                    
                    <p>This web site is going to be updated using <a href="http://nanoc.stoneship.org/">nanoc</a>. If you notice any dead
                    links or anything of the sort, please tell me.</p>
                  </div>
                </div>
          <div class='clear'></div>
        </div>
      </div>
      <div class='page-list'>
        <strong>Page:</strong>
        <ul class='page-list'>
          <li>
            <a href='1/'>1</a>
          </li>
          <li>
            <strong>latest</strong>
          </li>
        </ul>
      </div>
      <div class='clear'></div>
    </div>
    <div class='clear'></div>
<include-file src="../../footer.html" />
  </body>
</html>
